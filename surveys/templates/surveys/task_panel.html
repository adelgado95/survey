{% extends 'surveys/base.html' %}
{% block content %}
<ul class="nav">
    <li class="nav-item">
      <a class="nav-link active" href="#">Success: {{states.SUCCESS}}
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Pending: {{states.PENDING}}</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Failure: {{states.FAILURE}}</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Retry: {{states.RETRY}}</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">Total: {{states.TOTAL}}</a>
    </li>

    </ul>

    <table class="table table-bordered small">
        <thead>
          <tr>
            <th scope="col">Id</th>
            <th scope="col">Task Name</th>
            <th scope="col">Status</th>
            <th scope="col">Args</th>
            <th scope="col">Kwars</th>
            <th scope="col">State Time</th>
            <th scope="col">Action</th>

          </tr>
        </thead>
        <tbody>
          {% for task in tasks %}
          <tr>
              <th scope="row">{{task.task_id}}</th>
              <td>{{task.task_name}}</td>
              <td>{{task.celery_state}}</td>
              <td>{{task.arguments}}</td>
              <td>{{task.kwarguments}}</td>
              <td>{{task.state_datetime|date:'Y-m-d h:i:s'}}</td>
              <td>
                {% if task.celery_state == 'FAILURE' %}
                    <a class="nav-link" href="/celery_resend/{{task.task_name}}/{{task.arguments}}/{{task.kwarguments}}">Resend</a>                {% endif%}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
{% endblock content %}